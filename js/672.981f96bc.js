"use strict";(self["webpackChunktyy_trade"]=self["webpackChunktyy_trade"]||[]).push([[672],{86672:function(e,t,o){o.r(t),o.d(t,{default:function(){return le}});var r=function(){var e=this,t=e._self._c;return t("div",{staticStyle:{width:"100%",height:"100%",display:"flex","justify-content":"center","align-items":"center"}},[t("div",{staticClass:"login-container"},[t("h2",{staticClass:"login-title"},[e._v("用户登录")]),t("el-form",{ref:"loginForm",staticClass:"login-form",attrs:{model:e.loginForm,rules:e.loginRules}},[t("el-form-item",{attrs:{prop:"account"}},[t("h4",{staticStyle:{color:"black"}},[e._v("账号")]),t("el-input",{attrs:{placeholder:"请输入账号"},model:{value:e.loginForm.account,callback:function(t){e.$set(e.loginForm,"account",t)},expression:"loginForm.account"}})],1),t("el-form-item",{attrs:{prop:"password"}},[t("h4",{staticStyle:{color:"black"}},[e._v("密码")]),t("el-input",{attrs:{placeholder:"请输入密码",type:"password","show-password":""},model:{value:e.loginForm.password,callback:function(t){e.$set(e.loginForm,"password",t)},expression:"loginForm.password"}})],1),t("el-form-item",{staticClass:"captcha"},[t("h4",{staticStyle:{color:"black"}},[e._v("验证码")]),t("div",{staticClass:"captcha-input-container"},[t("el-input",{staticClass:"captcha-input",attrs:{placeholder:"请输入验证码"},model:{value:e.loginForm.code,callback:function(t){e.$set(e.loginForm,"code",t)},expression:"loginForm.code"}}),t("img",{directives:[{name:"show",rawName:"v-show",value:e.isCaptcha,expression:"isCaptcha"}],staticClass:"captcha-image",attrs:{src:e.imageCode,alt:"验证码"},on:{click:e.getCodeImage}})],1)]),t("el-form-item",{staticClass:"login-buttons"},[t("el-button",{staticClass:"login-button",attrs:{type:"primary"},on:{click:e.login}},[e._v("登录")])],1)],1),t("div",{staticClass:"login-options"},[t("div",{staticClass:"remember-account"},[t("el-checkbox",{model:{value:e.loginForm.remember,callback:function(t){e.$set(e.loginForm,"remember",t)},expression:"loginForm.remember"}},[e._v("记住账号")])],1),t("div",{staticClass:"register-link"},[t("router-link",{staticStyle:{color:"#0066cc"},attrs:{to:"/register"}},[e._v("立即注册")])],1)])],1)])},a=[],s=(o(57658),o(82801),o(1439),o(87585),o(55315),o(50246)),n=o(37662),i=o(56265),c=o.n(i),l=o(8499),u=o(1120);const d="3.7.5",h=d,m="function"===typeof atob,g="function"===typeof btoa,p="function"===typeof Buffer,f="function"===typeof TextDecoder?new TextDecoder:void 0,A="function"===typeof TextEncoder?new TextEncoder:void 0,_="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",y=Array.prototype.slice.call(_),E=(e=>{let t={};return e.forEach(((e,o)=>t[e]=o)),t})(y),b=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,C=String.fromCharCode.bind(String),P="function"===typeof Uint8Array.from?Uint8Array.from.bind(Uint8Array):e=>new Uint8Array(Array.prototype.slice.call(e,0)),T=e=>e.replace(/=/g,"").replace(/[+\/]/g,(e=>"+"==e?"-":"_")),w=e=>e.replace(/[^A-Za-z0-9\+\/]/g,""),U=e=>{let t,o,r,a,s="";const n=e.length%3;for(let i=0;i<e.length;){if((o=e.charCodeAt(i++))>255||(r=e.charCodeAt(i++))>255||(a=e.charCodeAt(i++))>255)throw new TypeError("invalid character found");t=o<<16|r<<8|a,s+=y[t>>18&63]+y[t>>12&63]+y[t>>6&63]+y[63&t]}return n?s.slice(0,n-3)+"===".substring(n):s},v=g?e=>btoa(e):p?e=>Buffer.from(e,"binary").toString("base64"):U,k=p?e=>Buffer.from(e).toString("base64"):e=>{const t=4096;let o=[];for(let r=0,a=e.length;r<a;r+=t)o.push(C.apply(null,e.subarray(r,r+t)));return v(o.join(""))},F=(e,t=!1)=>t?T(k(e)):k(e),x=e=>{if(e.length<2){var t=e.charCodeAt(0);return t<128?e:t<2048?C(192|t>>>6)+C(128|63&t):C(224|t>>>12&15)+C(128|t>>>6&63)+C(128|63&t)}t=65536+1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320);return C(240|t>>>18&7)+C(128|t>>>12&63)+C(128|t>>>6&63)+C(128|63&t)},B=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,S=e=>e.replace(B,x),R=p?e=>Buffer.from(e,"utf8").toString("base64"):A?e=>k(A.encode(e)):e=>v(S(e)),D=(e,t=!1)=>t?T(R(e)):R(e),I=e=>D(e,!0),N=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,$=e=>{switch(e.length){case 4:var t=(7&e.charCodeAt(0))<<18|(63&e.charCodeAt(1))<<12|(63&e.charCodeAt(2))<<6|63&e.charCodeAt(3),o=t-65536;return C(55296+(o>>>10))+C(56320+(1023&o));case 3:return C((15&e.charCodeAt(0))<<12|(63&e.charCodeAt(1))<<6|63&e.charCodeAt(2));default:return C((31&e.charCodeAt(0))<<6|63&e.charCodeAt(1))}},V=e=>e.replace(N,$),O=e=>{if(e=e.replace(/\s+/g,""),!b.test(e))throw new TypeError("malformed base64.");e+="==".slice(2-(3&e.length));let t,o,r,a="";for(let s=0;s<e.length;)t=E[e.charAt(s++)]<<18|E[e.charAt(s++)]<<12|(o=E[e.charAt(s++)])<<6|(r=E[e.charAt(s++)]),a+=64===o?C(t>>16&255):64===r?C(t>>16&255,t>>8&255):C(t>>16&255,t>>8&255,255&t);return a},L=m?e=>atob(w(e)):p?e=>Buffer.from(e,"base64").toString("binary"):O,Z=p?e=>P(Buffer.from(e,"base64")):e=>P(L(e).split("").map((e=>e.charCodeAt(0)))),M=e=>Z(X(e)),z=p?e=>Buffer.from(e,"base64").toString("utf8"):f?e=>f.decode(Z(e)):e=>V(L(e)),X=e=>w(e.replace(/[-_]/g,(e=>"-"==e?"+":"/"))),j=e=>z(X(e)),H=e=>{if("string"!==typeof e)return!1;const t=e.replace(/\s+/g,"").replace(/={0,2}$/,"");return!/[^\s0-9a-zA-Z\+/]/.test(t)||!/[^\s0-9a-zA-Z\-_]/.test(t)},q=e=>({value:e,enumerable:!1,writable:!0,configurable:!0}),G=function(){const e=(e,t)=>Object.defineProperty(String.prototype,e,q(t));e("fromBase64",(function(){return j(this)})),e("toBase64",(function(e){return D(this,e)})),e("toBase64URI",(function(){return D(this,!0)})),e("toBase64URL",(function(){return D(this,!0)})),e("toUint8Array",(function(){return M(this)}))},Y=function(){const e=(e,t)=>Object.defineProperty(Uint8Array.prototype,e,q(t));e("toBase64",(function(e){return F(this,e)})),e("toBase64URI",(function(){return F(this,!0)})),e("toBase64URL",(function(){return F(this,!0)}))},J=()=>{G(),Y()},Q={version:d,VERSION:h,atob:L,atobPolyfill:O,btoa:v,btoaPolyfill:U,fromBase64:j,toBase64:D,encode:D,encodeURI:I,encodeURL:I,utob:S,btou:V,decode:j,isValid:H,fromUint8Array:F,toUint8Array:M,extendString:G,extendUint8Array:Y,extendBuiltins:J};function W(e,t,o){let r=!o.custom||o.custom["isAlert"];if(r=void 0===r||r,r)if("ECONNABORTED"===e.code)(0,l.Message)({message:"请求超时"});else if(e.response&&e.response.data){const t=e.response.data;if(403===e.response.status||401===e.response.status)l.MessageBox.alert(t.msg||"登录已失效，请重新登录","提醒",{confirmButtonText:"确定",callback:()=>{s.Z.clear(),window.location.hash="/login"}});else if(500===e.response.status)(0,l.Message)({message:e.response.data});else{const t=e.response.data;4e4===t.code||40001===t.code||40002===t.code||40003===t.code||40005===t.code||40006===t.code||40008===t.code||40009===t.code?l.MessageBox.alert(t.msg||t.message,"提醒",{confirmButtonText:"确定",callback:()=>{s.Z.clear(),window.location.hash="/login"}}):t.msg?(0,l.Message)({message:t.msg}):t.message&&(0,l.Message)({message:t.message})}}else e.message&&(0,l.Message)({message:e.message});t(e)}function K(e,t,o){let r=!o.custom||o.custom["isAlert"];r=void 0===r||r;const a=e.data;!1===a.isSuccess&&(4e4===a.code||40001===a.code||40002===a.code||40003===a.code||40005===a.code||40006===a.code||40008===a.code?l.MessageBox.alert(a.msg,"提醒",{confirmButtonText:"确定",callback:()=>{window.location.hash="/login"}}):r&&l.Message.error(a.msg)),t(e)}c().interceptors.request.use((e=>{const t=!1!==e.headers["X-isToken"]||e.headers["X-isToken"],o=s.Z.get("TOKEN","");o&&t&&(e.headers.token="Bearer "+o);!1!==e.headers["X-isTenant"]||e.headers["X-isTenant"];const r={NODE_ENV:"production",VUE_APP_BASE_API:"/api",VUE_APP_HTTP_BASE_URL:"http://42.192.22.94/trading",VUE_APP_HZ_NEWS_URL:"http://42.192.22.94:8011",VUE_APP_IS_CAPTCHA:"true",VUE_APP_IS_MULTI_TENANT_TYPE:"NONE",VUE_APP_PROD_REQUEST_DOMAIN_PREFIX:"http://42.192.22.94",VUE_APP_PROJECT_NAME:"tyytrade-web",BASE_URL:""}.VUE_APP_CLIENT_ID,a={NODE_ENV:"production",VUE_APP_BASE_API:"/api",VUE_APP_HTTP_BASE_URL:"http://42.192.22.94/trading",VUE_APP_HZ_NEWS_URL:"http://42.192.22.94:8011",VUE_APP_IS_CAPTCHA:"true",VUE_APP_IS_MULTI_TENANT_TYPE:"NONE",VUE_APP_PROD_REQUEST_DOMAIN_PREFIX:"http://42.192.22.94",VUE_APP_PROJECT_NAME:"tyytrade-web",BASE_URL:""}.VUE_APP_CLIENT_SECRET;return e.headers["Authorization"]=`Basic ${Q.encode(`${r}:${a}`)}`,e.headers["Path"]=u.Z&&u.Z.history&&u.Z.history.current?u.Z.history.current.fullPath:"",e.headers["gray_version"]="zhitu",e}),(e=>Promise.reject(e))),c().interceptors.response.use((e=>e),(e=>Promise.reject(e)));const ee=e=>{const t={ts:Date.now()},o=e.method.toUpperCase(),r={method:o,baseURL:"http://42.192.22.94/api",url:e.url,responseType:e.responseType||"",timeout:e.custom&&e.custom["timeout"]||3e4};e["meta"]&&(r.headers=e["meta"]);const a=["PUT","POST","DELETE","PATCH"];a.includes(o)?(r.data=e.data||{},r.params=t):r.params={...t,...e.data||{}},e.formData&&(r.transformRequest=[e=>{const t=new FormData;return e&&Object.entries(e).forEach((e=>{t.append(e[0],e[1])})),t}]);const s=new Promise(((t,o)=>{c()(r).then((o=>{K(o,t,e)})).catch((t=>{W(t,o,e)}))}));return s};var te=ee;const oe={captcha:"/oauth/anno/captcha",login:"/oauth/noToken/login",logout:"/oauth/noToken/logout",router:"/oauth/menu/router",resource:"/oauth/resource/visible"};var re={getCaptcha(e){return te({method:"GET",url:oe.captcha+`?key=${e}`,responseType:"arraybuffer",meta:{"X-isToken":!1}})},login(e,t){return te({method:"POST",url:oe.login,data:e,meta:t})},logout(e,t){return te({method:"POST",formData:!0,url:oe.logout,data:e,meta:t})},getRouter(e){return te({method:"GET",url:oe.router,data:e||{}})},getResource(e){return te({method:"GET",url:oe.resource,data:e||{}})}},ae=o(4367),se={data(){return{isCaptcha:!0,imageCode:"",loginForm:{account:"zhitu",password:"888888",remember:!1,code:"",tenantView:"0000",tenant:"",key:(0,n.B5)(24,16),grantType:"captcha",bindAccount:"",bindPassword:"",signAccount:"",signPassword:""},loginRules:{account:[{required:!0,message:"请输入账号",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}],captcha:[{required:!0,message:"请输入验证码",trigger:"blur"}]}}},methods:{login(){this.loginForm.tenant=`${Q.encode(this.loginForm.tenantView)}`;const e=this;this.$store.commit("account/setTenant",this.loginForm.tenant),re.login(this.loginForm,{tenant:this.loginForm.tenant,"X-isTenant":!1}).then((t=>{const o=t.data;o.isSuccess&&(e.saveLoginData(o.data["token"],o.data["refreshToken"],o.data["expiration"]),e.saveUserInfo(o.data),this.$message({type:"success",message:"登录成功"}),this.$router.push("/home"),ae.Y.$emit("checkAvatar"))})).catch((e=>{console.log(e)}))},getCodeImage(){console.log("isCaptcha",this.isCaptcha),this.isCaptcha&&re.getCaptcha(this.loginForm.key).then((e=>{const t=e.data;return t.byteLength<=100&&this.$message({message:this.$t("tips.systemError"),type:"error"}),"data:image/png;base64,"+btoa(new Uint8Array(t).reduce(((e,t)=>e+String.fromCharCode(t)),""))})).then((e=>{this.imageCode=e})).catch((e=>{-1!==e.toString().indexOf("429")?this.$message({message:this.$t("tips.tooManyRequest"),type:"error"}):this.$message({message:this.$t("tips.getCodeImageFailed"),type:"error"})}))},saveLoginData(e,t,o){this.$store.commit("account/setToken",e),this.$store.commit("account/setRefreshToken",t),this.$store.commit("account/setExpireTime",o)},saveUserInfo(e){this.$store.commit("account/setUser",{id:e.userId,account:e.account,name:e.name,avatar:e.avatar,workDescribe:e.workDescribe})},keyDown(e){13===e.keyCode&&this.login()}},mounted(){s.Z.clear(),this.getCodeImage(),window.addEventListener("keydown",this.keyDown)},destroyed(){window.removeEventListener("keydown",this.keyDown,!1)}},ne=se,ie=o(1001),ce=(0,ie.Z)(ne,r,a,!1,null,"31fbe5da",null),le=ce.exports}}]);
//# sourceMappingURL=672.981f96bc.js.map